(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22b34f74"],{ade3:function(t,e,a){"use strict";function i(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}a.d(e,"a",(function(){return i}))},b64b:function(t,e,a){var i=a("23e7"),n=a("7b0b"),r=a("df75"),o=a("d039"),l=o((function(){r(1)}));i({target:"Object",stat:!0,forced:l},{keys:function(t){return r(n(t))}})},c975:function(t,e,a){"use strict";var i=a("23e7"),n=a("4d64").indexOf,r=a("b301"),o=[].indexOf,l=!!o&&1/[1].indexOf(1,-0)<0,s=r("indexOf");i({target:"Array",proto:!0,forced:l||s},{indexOf:function(t){return l?o.apply(this,arguments)||0:n(this,t,arguments.length>1?arguments[1]:void 0)}})},d2f1:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"stock"},[a("el-row",[a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{type:"primary"},on:{click:t.handleCreate}},[t._v("新增产品")])],1),a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入要搜索的编号"},model:{value:t.searchSerial,callback:function(e){t.searchSerial=e},expression:"searchSerial"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1)],1),a("el-table",{attrs:{data:t.filteredData}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return t._l(i.detectionInfo,(function(t,e){return a("div",{key:e,staticStyle:{width:"50%"}},[a("el-image",{staticStyle:{width:"30%"},attrs:{src:t.url,"preview-src-list":[t.url]}})],1)}))}}])}),a("el-table-column",{attrs:{prop:"serial",label:"原料名称"}}),a("el-table-column",{attrs:{prop:"amount",label:"数量"}}),a("el-table-column",{attrs:{prop:"amount2",label:"剩余数量"}}),a("el-table-column",{attrs:{prop:"details",label:"细节"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.handleEdit(e.row)}}},[t._v("编辑")]),a("el-popover",{ref:"popover"+e.$index},[a("p",[t._v("确定删除 "+t._s(e.row.stockName)+" 吗？")]),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.closeDeletePopover(e.$index)}}},[t._v("取消")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.handleDelete(e.row,e.$index)}}},[t._v("确定")])],1),a("el-button",{staticStyle:{"margin-left":"1rem"},attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[t._v("删除")])],1)]}}])})],1),a("el-dialog",{attrs:{title:t.editDialogTitle,width:"30%","before-close":t.handleEditDialogClose,visible:t.editDialogVisible,center:""}},[a("el-form",{attrs:{model:t.editDialogData}},[a("el-form-item",{attrs:{label:"编号"}},[a("el-input",{model:{value:t.editDialogData.serial,callback:function(e){t.$set(t.editDialogData,"serial",e)},expression:"editDialogData.serial"}})],1),a("el-form-item",{attrs:{label:"数量"}},[a("el-input",{model:{value:t.editDialogData.amount,callback:function(e){t.$set(t.editDialogData,"amount",e)},expression:"editDialogData.amount"}})],1),a("el-form-item",{attrs:{label:"细节"}},[a("el-input",{model:{value:t.editDialogData.details,callback:function(e){t.$set(t.editDialogData,"details",e)},expression:"editDialogData.details"}})],1),a("el-upload",{attrs:{action:"#","list-type":"picture-card","auto-upload":!0,"on-success":t.handleUploadImagesSuccess,"http-request":t.uploadImage,"file-list":t.editDialogData.detectionInfo},scopedSlots:t._u([{key:"file",fn:function(e){var i=e.file;return a("div",{},[a("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:i.url,alt:""}}),a("span",{staticClass:"el-upload-list__item-actions"},[a("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){return t.handleRemove(i)}}},[a("i",{staticClass:"el-icon-delete"})])])])}}])},[a("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.editDialogVisible=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.submitDialogData}},[t._v("确定")])],1)],1)],1)},n=[],r=(a("a4d3"),a("4de4"),a("c975"),a("e439"),a("dbb4"),a("b64b"),a("159b"),a("96cf"),a("1da1")),o=a("ade3"),l=a("2f62");function s(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function c(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?s(Object(a),!0).forEach((function(e){Object(o["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var u={data:function(){return{searchSerial:"",loading:!0,editDialogVisible:!1,editDialogTitle:"",editDialogData:{detectionInfo:[]},disabled:!1}},computed:c({filteredData:function(){var t=this,e=JSON.parse(JSON.stringify(this.productData));return e.forEach((function(t){t.detectionInfo&&(t.detectionInfo=JSON.parse(t.detectionInfo))})),this.searchSerial&&(e=e.filter((function(e){return-1!==e.serial.indexOf(t.searchSerial)}))),e}},Object(l["b"])(["productData"])),created:function(){this.fetch()},methods:{getURLList:function(t){var e=[];t.forEach((function(t){e.push(t.url)}))},handleEditDialogClose:function(t){var e=this;this.$confirm("确认关闭？").then((function(){t(),e.editDialogVisible=!1})).catch((function(){}))},closeDeletePopover:function(t){this.$refs["popover"+t].doClose()},fetch:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,this.$store.dispatch("fetchProductData");case 3:this.loading=!1;case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handleEdit:function(t){this.editDialogVisible=!0,this.editDialogTitle="编辑 "+t.serial,this.editDialogData=JSON.parse(JSON.stringify(t))},handleCreate:function(){this.editDialogVisible=!0,this.editDialogTitle="新增产品",this.editDialogData={detectionInfo:[]}},submitDialogData:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,this.editDialogVisible=!1,e=JSON.parse(JSON.stringify(this.editDialogData)),e.detectionInfo=[],this.editDialogData.detectionInfo.forEach((function(t){e.detectionInfo.push({url:t.url})})),e.detectionInfo=JSON.stringify(e.detectionInfo),t.next=8,this.$store.dispatch({type:"updateProductData",data:e});case 8:this.loading=!1;case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handleDelete:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.closeDeletePopover(a),this.loading=!0,t.next=4,this.$store.dispatch({type:"deleteProductDataById",data:e.id});case 4:this.loading=!1;case 5:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),handleUploadImagesSuccess:function(t,e,a){this.editDialogData.detectionInfo=a,e.url=t},handleRemove:function(t){this.editDialogData.detectionInfo=this.editDialogData.detectionInfo.filter((function(e){return e.url!==t.url}))},uploadImage:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=new FormData,a.append("upload",e.file),t.next=4,this.$http.post("/api/fileupload",a,{headers:{"Content-Type":"multipart/form-data"}});case 4:return i=t.sent,t.abrupt("return","http://localhost:8080/uploads/".concat(i.data.data.ImageName));case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}},d=u,f=a("2877"),p=Object(f["a"])(d,i,n,!1,null,null,null);e["default"]=p.exports},dbb4:function(t,e,a){var i=a("23e7"),n=a("83ab"),r=a("56ef"),o=a("fc6a"),l=a("06cf"),s=a("8418");i({target:"Object",stat:!0,sham:!n},{getOwnPropertyDescriptors:function(t){var e,a,i=o(t),n=l.f,c=r(i),u={},d=0;while(c.length>d)a=n(i,e=c[d++]),void 0!==a&&s(u,e,a);return u}})},e439:function(t,e,a){var i=a("23e7"),n=a("d039"),r=a("fc6a"),o=a("06cf").f,l=a("83ab"),s=n((function(){o(1)})),c=!l||s;i({target:"Object",stat:!0,forced:c,sham:!l},{getOwnPropertyDescriptor:function(t,e){return o(r(t),e)}})}}]);
//# sourceMappingURL=chunk-22b34f74.8695267e.js.map